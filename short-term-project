var _EMAIL_ = 'CNFM SENT';
function candidateID() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("1");
  var startRow = 2; // First row of data to process
  var numRows = 20; // Number of rows to process
  var startCol = 1;
  var numCol=16;
  
  var dataRange = sheet.getRange(startRow, startCol, numRows, numCol);
  // Fetch values for each row in the Range.
  var data = dataRange.getValues();
  for (var i = 0; i < data.length; ++i) {
   
    var row = data[i];
    var emailAddress = row[1]; // First column
    var name = row[3];
    var division = row[7];
    var prcode = row[8]
    var res_exp = row[9];
    var skill = row[11];
    var publication = row[12];
    var cv = row[13];

    var message_to_cand = "Dear "+name+",\nThankyou for your submission. Prior to the offering the candidature the lead/co-lead might choose to conduct a short interview/call prior to the decision. Please fill attached form (https://forms.gle/DtC7kB8uFLySuhi59) as a part of recruitment process. It is mandatory to fill the form and might take around 10-15 minutes of you time. \nIn case if you donot hear from us within a 20 days please mail us at bosexorg@gmail.com. In the meantime you can go through our website at https://www.bosex.org/.\n\nTeam Bose.X\n\n\n**This an automated response. Donot reply to this message rather mail at the aforementioned ID**";
    
    var message_to_bosex = "A response has been submitted\n\nName:"+name+"\nEmail ID: "+emailAddress+"\nPROJECT CODE: "+prcode+"\n\n"+"\n*Research Exp*:\n"+res_exp+"\n*SKILLS*:\n"+skill+"\n*PUBLICATION*\n"+publication+"\n*CV*\n"+cv;
    var emailSent = row[14];
    var update_at_col = 15
    if (emailSent !== _EMAIL_) { // Prevents sending duplicates
      var subject = 'Confirmation of response';
      MailApp.sendEmail(emailAddress, subject, message_to_cand);
      MailApp.sendEmail("bosexorg@gmail.com", subject, message_to_bosex);

      if (division == "XCQR"){MailApp.sendEmail("suyashthinker@gmail.com", subject, message_to_bosex);
      MailApp.sendEmail("ankulprajapati7@gmail.com", subject, message_to_bosex)}
      else if ((division == "XCESR") || (division == "XCRSD")){MailApp.sendEmail("guptaaditya746@gmail.com", subject, message_to_bosex)}
      else if (division == "XCAR"){//MailApp.sendEmail("saurabhsharma8689@gmail.com", subject, message_to_bosex);
      //MailApp.sendEmail("sshwetankindia@gmail.com", subject, message_to_bosex);
      MailApp.sendEmail("shashwat98singh@gmail.com", subject, message_to_bosex);}
      
      else if (division == "XCNR"){MailApp.sendEmail("test@gmail.com", subject, message_to_bosex)}
      sheet.getRange(startRow + i, update_at_col).setValue(_EMAIL_);
      SpreadsheetApp.flush();
    }
  }
}
